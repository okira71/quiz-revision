<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bac Français - Révision Facile</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Font Awesome pour les icônes (menu burger, utilisateur, etc.) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <a href="index.html" class="logo">
                <img src="assets/logo.png" alt="Logo Bac Français" class="logo-img">
                <span class="logo-text">Bac Français</span>
            </a>
            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="index.html">Accueil</a></li>
                    <li><a href="revision.html">Révisions</a></li>
                    <li><a href="classement.html">Classement</a></li>
                    <li class="user-controls">
                        <button id="btn-login-header" class="btn btn-primary">Connexion</button>
                        <button id="btn-signup-header" class="btn btn-secondary">Créer un compte</button>
                        <div id="user-profile-info" class="user-profile-info hidden">
                            <span id="welcome-message">Bienvenue, Utilisateur!</span>
                            <button id="btn-logout" class="btn btn-danger">Déconnexion</button>
                        </div>
                    </li>
                </ul>
                <button class="burger-menu-toggle" aria-label="Ouvrir le menu">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <main class="main-content container">
        <section class="hero">
            <h1>Préparez le Bac de Français sereinement !</h1>
            <p>Accédez à des fiches, des lectures linéaires interactives et des quiz pour maîtriser toutes les notions.</p>
            <div class="hero-actions">
                <a href="revision.html" class="btn btn-primary btn-large">Commencer les révisions</a>
                <a href="classement.html" class="btn btn-secondary btn-large">Voir le classement</a>
            </div>
        </section>

        <section class="quick-access-section">
            <h2>Accès Rapide</h2>
            <div class="quick-access-grid">
                <a href="revision.html" class="quick-access-card">
                    <i class="fas fa-book-open"></i>
                    <h3>Fiches de Révision</h3>
                    <p>Consultez des résumés clairs sur les auteurs, mouvements et figures de style.</p>
                </a>
                <a href="revision.html#quiz" class="quick-access-card">
                    <i class="fas fa-question-circle"></i>
                    <h3>Quiz Interactifs</h3>
                    <p>Testez vos connaissances avec des QCM thématiques et un corrigé instantané.</p>
                </a>
                <a href="classement.html" class="quick-access-card">
                    <i class="fas fa-trophy"></i>
                    <h3>Votre Classement</h3>
                    <p>Mesurez votre progression et comparez-vous aux autres élèves.</p>
                </a>
            </div>
        </section>

        <section class="featured-section">
            <h2>À la Une !</h2>
            <div class="featured-grid">
                <div class="featured-card">
                    <h3>Fiche du Jour : Le Romantisme</h3>
                    <p>Découvrez les caractéristiques principales de ce mouvement littéraire essentiel.</p>
                    <a href="revision.html#fiche-romantisme" class="btn btn-link">Lire la fiche</a>
                </div>
                <div class="featured-card">
                    <h3>Citation Inspirante</h3>
                    <blockquote>"L'art est le plus beau des mensonges." <small>— Claude Monet</small></blockquote>
                    <p>Une pensée pour la profondeur et la complexité de l'expression artistique.</p>
                </div>
                <div class="featured-card">
                    <h3>Vos Stats de la Semaine</h3>
                    <p><strong>Quiz Réussis :</strong> <span id="stats-quiz-success">0</span></p>
                    <p><strong>Fiches Lues :</strong> <span id="stats-fiches-read">0</span></p>
                    <p><strong>Temps Passé :</strong> <span id="stats-time-spent">0</span> min</p>
                    <a href="profil.html" class="btn btn-link">Voir mon profil</a>
                </div>
            </div>
        </section>

        <section class="leaderboard-preview">
            <h2>Top 5 du Classement</h2>
            <div id="top-5-leaderboard" class="leaderboard-list">
                <!-- Les utilisateurs du top 5 seront insérés ici par JS -->
                <p>Chargement du classement...</p>
            </div>
            <a href="classement.html" class="btn btn-primary mt-4">Voir le classement complet</a>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Bac Français. Tous droits réservés.</p>
            <nav class="footer-nav">
                <a href="#">Mentions Légales</a>
                <a href="#">Confidentialité</a>
                <a href="#">Contact</a>
            </nav>
        </div>
    </footer>

    <!-- Modals pour Connexion / Inscription / Message -->
    <div id="auth-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <h2 id="auth-modal-title">Connexion</h2>
            <form id="auth-form">
                <div class="form-group">
                    <label for="username">Nom d'utilisateur :</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Mot de passe :</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" id="auth-submit-btn" class="btn btn-primary">Se connecter</button>
            </form>
            <p class="modal-switch-text">
                <span id="switch-to-signup-text">Pas encore de compte ? <a href="#" id="switch-to-signup-link">Créer un compte</a></span>
                <span id="switch-to-login-text" class="hidden">Déjà un compte ? <a href="#" id="switch-to-login-link">Se connecter</a></span>
            </p>
        </div>
    </div>

    <div id="message-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <h2 id="message-modal-title"></h2>
            <p id="message-modal-text"></p>
            <button class="btn btn-primary modal-ok-btn">OK</button>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // Initialisation de la page d'accueil après le chargement du DOM
        document.addEventListener('DOMContentLoaded', () => {
            // Mise à jour du message de bienvenue et des stats si un utilisateur est connecté
            const userManager = UserManager.getInstance();
            userManager.init(); // Tente de charger l'utilisateur depuis localStorage

            if (userManager.currentUser) {
                document.getElementById('btn-login-header').classList.add('hidden');
                document.getElementById('btn-signup-header').classList.add('hidden');
                const welcomeMessageElement = document.getElementById('welcome-message');
                welcomeMessageElement.textContent = `Bienvenue, ${userManager.currentUser.username} !`;
                document.getElementById('user-profile-info').classList.remove('hidden');

                // Mettre à jour les stats de la semaine
                document.getElementById('stats-quiz-success').textContent = userManager.currentUser.quizHistory.filter(q => q.success).length;
                document.getElementById('stats-fiches-read').textContent = userManager.currentUser.fichesConsulted.length;
                // Afficher le temps en minutes
                document.getElementById('stats-time-spent').textContent = Math.round(userManager.currentUser.timeSpent / 60000); // Convertir ms en minutes

            } else {
                // Si aucun utilisateur n'est connecté, cacher les stats (ou afficher 0)
                document.getElementById('stats-quiz-success').textContent = '0';
                document.getElementById('stats-fiches-read').textContent = '0';
                document.getElementById('stats-time-spent').textContent = '0';
            }

            // Afficher le top 5 du classement (même si aucun utilisateur n'est connecté)
            const allUsers = userManager.getAllUsers();
            const sortedUsers = allUsers.sort((a, b) => b.score - a.score).slice(0, 5);
            const leaderboardList = document.getElementById('top-5-leaderboard');
            leaderboardList.innerHTML = ''; // Nettoyer le message de chargement

            if (sortedUsers.length > 0) {
                sortedUsers.forEach((user, index) => {
                    const userEntry = document.createElement('div');
                    userEntry.className = 'leaderboard-entry';
                    userEntry.innerHTML = `
                        <span>#${index + 1} ${user.username}</span>
                        <span>Score: ${user.score}</span>
                    `;
                    leaderboardList.appendChild(userEntry);
                });
            } else {
                leaderboardList.innerHTML = '<p>Aucun utilisateur enregistré pour le moment. Créez un compte et commencez à réviser !</p>';
            }
        });
    </script>
</body>
</html>
